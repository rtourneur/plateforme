---
# Register the docker server in a file on the platform

- hosts: docker

  tasks:
  
  - name: create the temp directory in local
    local_action: file path=/tmp/deployment state=directory

  - name: create the inventory file in local
    local_action: shell echo 'server={{inventory_hostname}}' >> /tmp/deployment/{{application}}-{{env}}.properties

- hosts: platform

  tasks: 

  - name: push the inventory file 
    copy:
      src: "/tmp/deployment/{{application}}-{{env}}.properties"
      dest: /opt/data/deployment/

  - name: delete the inventory file in local
    local_action: file path="/tmp/deployment/{{application}}-{{env}}.properties" state=absent
